import express, { Router, Request, Response, NextFunction } from 'express';
import tougthsRouter from './Tougths/tougthsRouter';
import authRouter from './Auth/authRouter';
import TougthsController from '../controllers/Toughts/TougthsController';
import AuthController from '../controllers/Auth/AuthController';

const router = Router();

//????????????????????????????????????????????????????????????????? configuracoes
router.use(express.urlencoded({ extended: true }));
router.use(express.json());
//????????????????????????????????????????????????????????????????? configuracoes

/* rota base */
router.get('/', (req: Request, res: Response) => {
  if (req.session.userid)
    TougthsController.showToughts(req, res);
  else {
    req.flash('message', 'Usuário não autenticado.');
    AuthController.login(req, res);
  }
});

/* rotas por model */
router.use('/auth', authRouter);
router.use('/toughts', tougthsRouter);

export default router;

//http://localhost:3000/toughts/dashboard